<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>js\controllers\dronesController.js - The cros-admin API</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="The cros-admin API" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/.CustomAdapter.html">.CustomAdapter</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: js\controllers\dronesController.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * Created by Eveline on 25/03/2015.
 */
App.DronesController = App.ListSuperController.extend({
    columns : [{label:&#x27;#&#x27;, value:&quot;id&quot;, sortable:1},
                {label:&#x27;Name&#x27;, value: &quot;name&quot;, sortable:1},
                {label:&#x27;Status&#x27;, value:&quot;status&quot;, sortable:1},
                {label:&#x27;Emergency&#x27;, sortable:0},
                {label:&#x27;Actions&#x27;, sortable:0}
    ],
    element : &quot;drone&quot;,
    searchFields : [&quot;name&quot;],
    total: null,

    actions:{
        emergency: function(id){
            this.adapter.find(&#x27;drone&#x27;,id,&quot;emergency&quot;).then(function(data){
                console.log(data);
            });
        }
    }
});

App.TypeController = Ember.ObjectController.extend({
    isSelected: function() {
        return this.get(&quot;selected&quot;);
    }.property()
});

App.DroneEditController = Ember.Controller.extend({
    needs: &#x27;drones&#x27;,
    index: Ember.computed.alias(&quot;controllers.drones&quot;),
	nameError: &quot;&quot;,
	addressError: &quot;&quot;,
	typeError: &quot;&quot;,
	weightError: &quot;&quot;,
    hasNameError : function() {
        return this.get(&#x27;nameError&#x27;) !== &quot;&quot;;
    }.property(&#x27;nameError&#x27;),
    hasAddressError : function() {
        return this.get(&#x27;addressError&#x27;) !== &quot;&quot;;
    }.property(&#x27;addressError&#x27;),
    hasTypeError : function() {
        return this.get(&#x27;typeError&#x27;) !== &quot;&quot;;
    }.property(&#x27;typeError&#x27;),
    hasWeightError : function() {
        return this.get(&#x27;weightError&#x27;) !== &quot;&quot;;
    }.property(&#x27;weightError&#x27;),

	success: function(id) {
		this.transitionToRoute(&#x27;drone&#x27;, id);
	},

    isAvailableState : function() {
        return this.get(&quot;model.status&quot;) == &quot;AVAILABLE&quot;;
    }.property(&quot;model.status&quot;),

    isChargingState : function() {
        return this.get(&quot;model.status&quot;) == &quot;CHARGING&quot;;
    }.property(&quot;model.status&quot;),

    isInactiveState : function() {
        return this.get(&quot;model.status&quot;) == &quot;INACTIVE&quot;;
    }.property(&quot;model.status&quot;),

    isRetiredState : function() {
        return this.get(&quot;model.status&quot;) == &quot;RETIRED&quot;;
    }.property(&quot;model.status&quot;),

    isManualState : function() {
        return this.get(&quot;model.status&quot;) == &quot;MANUAL_CONTROL&quot;;
    }.property(&quot;model.status&quot;),

    updateSelected : function() {
        var self = this;
        var types = this.get(&quot;types&quot;) || [];
        var noneSelected = true;
        $.each(types, function() {
            var condition = this.type === self.get(&quot;model.droneType&quot;).type;
            noneSelected = noneSelected &amp;&amp; !condition;
            this.set(&quot;selected&quot;, condition);
        });
        if (noneSelected &amp;&amp; types[0]) {
            Ember.set(this.get(&quot;model&quot;), &quot;droneType&quot;, types[0]);
        }
    }.observes(&quot;types&quot;, &quot;model.droneType&quot;),

	failure: function(data) {
        if(typeof data.responseJSON === &#x27;string&#x27; || data.responseJSON.reason) {
			if(!$(&#x27;#droneAlert&#x27;)[0]) {
				$(&#x27;#droneAddAlert&#x27;)
					.append($(&#x27;&lt;div&gt;&#x27;)
						.attr(&#x27;id&#x27;, &#x27;droneAlert&#x27;)
						.attr(&#x27;class&#x27;, &#x27;alert alert-danger alert-dismissible&#x27;)
						.attr(&#x27;role&#x27;, &#x27;alert&#x27;)
					);
			}
			$(&#x27;#droneAlert&#x27;).text(&#x27;&#x27;);
			if (typeof data.responseJSON === &#x27;string&#x27;)
				$(&#x27;#droneAlert&#x27;).append($(&#x27;&lt;p&gt;&#x27;).text(data.responseJSON));
			if (data.responseJSON.reason)
				$(&#x27;#droneAlert&#x27;).append($(&#x27;&lt;p&gt;&#x27;).text(data.responseJSON.reason));
		}
		this.set(&#x27;nameError&#x27;, data.responseJSON.name || &quot;&quot;);
		this.set(&#x27;addressError&#x27;, data.responseJSON.address || &quot;&quot;);
		this.set(&#x27;typeError&#x27;, data.responseJSON.droneType || &quot;&quot;);
		this.set(&#x27;weightError&#x27;, data.responseJSON.weightLimitation || &quot;&quot;);
	},
	
	actions: {
		save: function(){
			var jsonObject = { drone: this.model };
            Ember.set(jsonObject.drone, &quot;status&quot;, jsonObject.drone.status || &quot;AVAILABLE&quot;);
			if(this.model.id)
				var result = this.adapter.edit(&#x27;drone&#x27;, this.model.id, jsonObject);
			else
				var result = this.adapter.post(&#x27;drone&#x27;, jsonObject);
			var self = this;
			result.then(
				function(data) {
                    self.success(data.drone.id);
                    self.get(&#x27;index&#x27;).refresh();
                },
				function(data) {
                    self.failure(data);
                    self.get(&#x27;index&#x27;).refresh();
                }
			);
		},

        updateType : function(type) {
            var typeString = $(&quot;#typeSelector select option:selected&quot;).text();
            var type = typeString.split(&quot; (&quot;)[0];
            var version = typeString.split(&quot; (&quot;)[1].slice(0,-1);
            var selectedType = this.get(&quot;types&quot;).filter(function(t) {
                return t.type === type &amp;&amp; t.versionNumber === version;
            });
            this.set(&quot;model.droneType&quot;, selectedType[0]);
        },

        setState : function(state) {
            this.set(&quot;model.status&quot;, state);
        }
	}
});
    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
